{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 16, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ikram/Desktop/clinical/src/pages/login.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useState } from \"react\";\r\nimport { signIn } from \"next-auth/react\";\r\nimport { toast } from \"sonner\";\r\n\r\nexport default function LoginPage() {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n\r\n  const onSubmit = async (e: React.FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault();\r\n    setIsLoading(true);\r\n\r\n    const formData = new FormData(e.currentTarget);\r\n    const email = formData.get(\"email\") as string;\r\n    const password = formData.get(\"password\") as string;\r\n\r\n    try {\r\n      const res = await signIn(\"credentials\", {\r\n        redirect: false,\r\n        email,\r\n        password,\r\n      });\r\n\r\n      if (res?.error) {\r\n        toast.error(\"Email ou mot de passe incorrect\");\r\n      } else {\r\n        toast.success(\"Connexion r√©ussie !\");\r\n\r\n        // üî• Redirection selon r√¥le\r\n        const sessionRes = await fetch(\"/api/auth/session\");\r\n        const sessionData = await sessionRes.json();\r\n        const role = sessionData?.user?.role;\r\n\r\n        if (role === \"PATIENT\") {\r\n          window.location.href = \"/patient\";\r\n        } else if (role === \"DOCTOR\") {\r\n          window.location.href = \"/doctor/dashboard\";\r\n        } else if (role === \"RECEPTIONIST\") {\r\n          window.location.href = \"/receptionist/dashboard\";\r\n        } else if (role === \"ADMIN\") {\r\n          window.location.href = \"/admin/dashboard\";\r\n        } else {\r\n          window.location.href = \"/\";\r\n        }\r\n      }\r\n    } catch (err) {\r\n      toast.error(\"Erreur serveur ou r√©seau\");\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"bg-[#eaf7ff] min-h-screen flex justify-center items-center px-4\">\r\n      <form\r\n        onSubmit={onSubmit}\r\n        className=\"bg-white p-8 md:p-12 rounded-3xl shadow-lg w-full max-w-[430px]\"\r\n      >\r\n        <h1 className=\"text-2xl font-bold text-blue-600 mb-6 text-center\">\r\n          DiagnoTech Login\r\n        </h1>\r\n\r\n        <input\r\n          type=\"email\"\r\n          name=\"email\"\r\n          placeholder=\"Email\"\r\n          required\r\n          className=\"w-full mb-4 p-2 border-b\"\r\n        />\r\n        <input\r\n          type=\"password\"\r\n          name=\"password\"\r\n          placeholder=\"Mot de passe\"\r\n          required\r\n          minLength={6}\r\n          className=\"w-full mb-4 p-2 border-b\"\r\n        />\r\n\r\n        <button\r\n          type=\"submit\"\r\n          disabled={isLoading}\r\n          className=\"w-full bg-blue-600 hover:bg-blue-800 text-white py-2 rounded-full\"\r\n        >\r\n          {isLoading ? \"Connexion...\" : \"Se connecter\"}\r\n        </button>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;;;AAJA;;;;;AAMe,SAAS;IACtB,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,+GAAQ,EAAC;IAE3C,MAAM,WAAW,OAAO;QACtB,EAAE,cAAc;QAChB,aAAa;QAEb,MAAM,WAAW,IAAI,SAAS,EAAE,aAAa;QAC7C,MAAM,QAAQ,SAAS,GAAG,CAAC;QAC3B,MAAM,WAAW,SAAS,GAAG,CAAC;QAE9B,IAAI;YACF,MAAM,MAAM,MAAM,IAAA,6IAAM,EAAC,eAAe;gBACtC,UAAU;gBACV;gBACA;YACF;YAEA,IAAI,KAAK,OAAO;gBACd,qHAAK,CAAC,KAAK,CAAC;YACd,OAAO;gBACL,qHAAK,CAAC,OAAO,CAAC;gBAEd,4BAA4B;gBAC5B,MAAM,aAAa,MAAM,MAAM;gBAC/B,MAAM,cAAc,MAAM,WAAW,IAAI;gBACzC,MAAM,OAAO,aAAa,MAAM;gBAEhC,IAAI,SAAS,WAAW;oBACtB,OAAO,QAAQ,CAAC,IAAI,GAAG;gBACzB,OAAO,IAAI,SAAS,UAAU;oBAC5B,OAAO,QAAQ,CAAC,IAAI,GAAG;gBACzB,OAAO,IAAI,SAAS,gBAAgB;oBAClC,OAAO,QAAQ,CAAC,IAAI,GAAG;gBACzB,OAAO,IAAI,SAAS,SAAS;oBAC3B,OAAO,QAAQ,CAAC,IAAI,GAAG;gBACzB,OAAO;oBACL,OAAO,QAAQ,CAAC,IAAI,GAAG;gBACzB;YACF;QACF,EAAE,OAAO,KAAK;YACZ,qHAAK,CAAC,KAAK,CAAC;QACd,SAAU;YACR,aAAa;QACf;IACF;IAEA,qBACE,qKAAC;QAAI,WAAU;kBACb,cAAA,qKAAC;YACC,UAAU;YACV,WAAU;;8BAEV,qKAAC;oBAAG,WAAU;8BAAoD;;;;;;8BAIlE,qKAAC;oBACC,MAAK;oBACL,MAAK;oBACL,aAAY;oBACZ,QAAQ;oBACR,WAAU;;;;;;8BAEZ,qKAAC;oBACC,MAAK;oBACL,MAAK;oBACL,aAAY;oBACZ,QAAQ;oBACR,WAAW;oBACX,WAAU;;;;;;8BAGZ,qKAAC;oBACC,MAAK;oBACL,UAAU;oBACV,WAAU;8BAET,YAAY,iBAAiB;;;;;;;;;;;;;;;;;AAKxC"}}]
}