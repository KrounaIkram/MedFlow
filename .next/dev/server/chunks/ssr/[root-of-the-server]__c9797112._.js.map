{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/ikram/Desktop/clinical/src/pages/admin/dashboard.tsx"],"sourcesContent":["// src/server/rbac.ts\r\nimport type { NextApiRequest, NextApiResponse } from \"next\";\r\nimport { getServerSession } from \"next-auth/next\";\r\nimport { authOptions } from \"../lib/auth\"; // ton fichier NextAuth\r\nimport { Role } from \"@prisma/client\";\r\n\r\nexport async function requireRole(\r\n  req: NextApiRequest,\r\n  res: NextApiResponse,\r\n  roles: Role[] = []\r\n) {\r\n  const session = await getServerSession(req, res, authOptions);\r\n\r\n  if (!session) {\r\n    res.status(401).json({ error: \"Not authenticated\" });\r\n    return null;\r\n  }\r\n\r\n  if (roles.length && !roles.includes(session.user.role as Role)) {\r\n    res.status(403).json({ error: \"Access denied\" });\r\n    return null;\r\n  }\r\n\r\n  return session;\r\n}\r\n"],"names":[],"mappings":"AAAA,qBAAqB;;;;;AAErB;;;;;;;;AAIO,eAAe,YACpB,GAAmB,EACnB,GAAoB,EACpB,QAAgB,EAAE;IAElB,MAAM,UAAU,MAAM,IAAA,qJAAgB,EAAC,KAAK,KAAK;IAEjD,IAAI,CAAC,SAAS;QACZ,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAoB;QAClD,OAAO;IACT;IAEA,IAAI,MAAM,MAAM,IAAI,CAAC,MAAM,QAAQ,CAAC,QAAQ,IAAI,CAAC,IAAI,GAAW;QAC9D,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAgB;QAC9C,OAAO;IACT;IAEA,OAAO;AACT"}}]
}